<!-- ==============================================
     Main wrapper
============================================== -->
<main class="product-page-root" *ngIf="!loading && product; else loadingTpl">

    <!-- ==============================================
       Product main section
  ============================================== -->
    <section class="product-main-section">
        <div class="product-grid">

            <!-- ========== Gallery ========== -->
            <div class="gallery">

                <!-- main large image -->
                <div class="main-image-holder">
                    <img [src]="mainImage" [alt]="product.name" />
                </div>

                <!-- thumbnails -->
                <div class="thumbnails">
                    <div class="thumb" *ngFor="let img of thumbnails; let i = index" [class.active]="img === mainImage"
                        (click)="changeProductImage(img)">
                        <img [src]="img" [alt]="product.name + ' thumbnail ' + i" />
                    </div>
                </div>
            </div>

            <!-- ========== Product info ========== -->
            <div class="product-info">

                <!-- Product title -->
                <h1>{{ product.name }}</h1>

                <!-- Rating / reviews -->
                <div class="rating-wrapper">
                    <div class="stars">
                        <!-- ممكن تستبدل بـ دالة أو Pipe ترسم النجوم حسب rating -->
                        ★★★★☆
                    </div>
                    <span class="review-count">
                        <!-- ( {{ product.reviews || 0 }} reviews ) -->
                    </span>
                </div>

                <!-- Price -->
                <div class="product-price">
                    ${{ product.price }}
                </div>

                <!-- Description -->
                <p class="description">
                    {{ product.description }}
                </p>

                <!-- Meta data: availability, brand, category -->
                <div class="meta-data">
                    <p>
                        <strong>Availability:</strong>
                        <span>
                            {{ product.stock && product.stock > 0 ? 'In Stock' : 'Out of Stock' }}
                        </span>
                    </p>
                    <p>
                        <strong>Brand:</strong>
                        <span>{{ product.brand || '-' }}</span>
                    </p>
                    <p>
                        <strong>Category:</strong>
                        <span>{{ product.category || '-' }}</span>
                    </p>
                </div>

                <!-- Actions: quantity + add to cart -->
                <div class="actions-group">

                    <!-- quantity -->
                    <div class="quantity-selector">
                        <button class="qty-btn" (click)="updateQuantity(-1)">-</button>
                        <input class="qty-input" type="text" [value]="quantity" readonly />
                        <button class="qty-btn" (click)="updateQuantity(1)">+</button>
                    </div>


                    <!-- Add to cart -->
                    <button class="add-to-cart-btn" (click)="addToCart()" [disabled]="product.stock === 0">
                        {{ product.stock === 0 ? 'Out of Stock' : 'Add to Cart' }}
                    </button>

                </div>
            </div>
        </div>
    </section>

    <!-- ==============================================
       Related products (static example; لاحقًا ممكن ديناميكية)
  ============================================== -->
    <section class="related-products-section">
        <h2 class="section-title-custom">Related Products</h2>
        <div class="related-products-grid">

            <!-- <div class="related-product-card" *ngFor="let r of relatedExample">
                <div class="related-card-image">
                    <img [src]="r.image" [alt]="r.name" />
                </div>
                <div class="related-card-content">
                    <h3>{{ r.name }}</h3>
                    <p class="related-card-price">${{ r.price }}</p>
                    <a class="btn-primary" routerLink="['/products', r._id]"
                        style="display: block; text-align: center;">
                        View Details
                    </a>
                </div>
            </div> -->

        </div>
    </section>

    <!-- ==============================================
       Reviews section (static sample; يمكن تعديلها)
  ============================================== -->
    <section class="reviews-section-content">
        <h2 class="section-title-custom">Customer Reviews</h2>

        <!-- <div class="review-item" *ngFor="let review of dummyReviews; let i = index"
            [class.expanded]="expandedReviewIndex === i" (click)="toggleReview(i)">
            <div class="review-header">
                <div class="review-user-info">
                    {{ review.user }}
                    <div class="review-stars-small">
                        {{ review.stars }}
                    </div>
                </div>
                <i class="fas fa-chevron-down"></i>
            </div>

            <div class="review-content">
                {{ review.text }}
            </div>
        </div> -->
    </section>



</main>

<!-- ==============================================
     Loading template
============================================== -->
<ng-template #loadingTpl>
    <div class="loading">
        Loading product...
    </div>
</ng-template>

<!-- ==============================================
     Error template
============================================== -->
<div *ngIf="error" class="error">
    Product not found or an error occurred.
</div>