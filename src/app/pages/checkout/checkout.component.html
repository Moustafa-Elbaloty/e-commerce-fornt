<div class="container">

  <h1>Checkout</h1>
  <div class="subtitle">
    Finalize your purchase by providing shipping and payment details.
  </div>

  <div class="checkout-grid">

    <!-- ================= Shipping ================= -->
    <div class="card">
      <h2>Shipping Information</h2>

      <div class="form-row">
        <div class="form-group">
          <label>First Name</label>
          <input type="text" name="firstName"
            [(ngModel)]="shipping.firstName"
            [class.error]="submitted && isEmpty(shipping.firstName)">
        </div>

        <div class="form-group">
          <label>Last Name</label>
          <input type="text" name="lastName"
            [(ngModel)]="shipping.lastName"
            [class.error]="submitted && isEmpty(shipping.lastName)">
        </div>
      </div>

      <div class="form-group">
        <label>Address Line 1</label>
        <input type="text" name="address1"
          [(ngModel)]="shipping.address1"
          [class.error]="submitted && isEmpty(shipping.address1)">
      </div>

      <div class="form-group">
        <label>Address Line 2</label>
        <input type="text" name="address2"
          [(ngModel)]="shipping.address2"
          [class.error]="submitted && isEmpty(shipping.address2)">
      </div>

      <div class="form-group">
        <label>Governorate</label>
        <select name="governorate"
          [(ngModel)]="shipping.governorate"
          [class.error]="submitted && isEmpty(shipping.governorate)">
          <option value="">Select Governorate</option>
          <option *ngFor="let g of egyptGovernorates" [value]="g">
            {{ g }}
          </option>
        </select>
      </div>

      <div class="form-group">
        <label>City</label>
        <input type="text" name="city"
          [(ngModel)]="shipping.city"
          [class.error]="submitted && isEmpty(shipping.city)">
      </div>

      <div class="form-group">
        <label>Phone</label>
        <input type="text" name="phone"
          [(ngModel)]="shipping.phone"
          (input)="formatPhone()"
          [class.error]="submitted && invalidPhone()">
      </div>
    </div>

    <!-- ================= Order Summary ================= -->
    <div class="card order-summary">
      <h2>Order Summary</h2>

      <div class="order-item" *ngFor="let item of cartItems">
        <img [src]="item.image">
        <div>{{ item.name }} (x{{ item.qty }})</div>
        <div>${{ item.price * item.qty }}</div>
      </div>

      <button class="btn" (click)="placeOrder()">Place Order</button>

      <p class="error-msg" *ngIf="formError">
        ⚠️ {{ formError }}
      </p>
    </div>

    <!-- ================= Payment ================= -->
    <div class="card">
      <h2>Payment Method</h2>

      <div class="payment-options">
        <label>
          <input type="radio" name="paymentType" value="credit"
            [(ngModel)]="paymentType">
          Credit Card
        </label>

        <label>
          <input type="radio" name="paymentType" value="cash"
            [(ngModel)]="paymentType">
          Cash on Delivery
        </label>
      </div>

      <div *ngIf="paymentType === 'credit'">
        <input type="text" name="cardNumber"
          placeholder="Card Number"
          [(ngModel)]="card.number"
          (input)="formatCardNumber()"
          [class.error]="submitted && invalidCardNumber()">

        <input type="text" name="expiry"
          placeholder="MM/YY"
          [(ngModel)]="card.expiry"
          (input)="formatExpiry()"
          [class.error]="submitted && invalidExpiry()">

        <input type="text" name="cvv"
          placeholder="CVV"
          [(ngModel)]="card.cvv"
          (input)="formatCVV()"
          [class.error]="submitted && invalidCVV()">
      </div>
    </div>

  </div>
</div>
